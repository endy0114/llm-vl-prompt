## 工具作用

**目标：** 让大家能够使用命令行快速的优化和测试多模态大模型进行图片识别的prompt


## 工具使用

 - **指令：**

```shell

Usage: lvt.exe [OPTIONS]

Options:
  -c, --config-path <CONFIG_PATH>  [default: config]  ## 配置文件路径，默认为当前config目录
  -i, --image-path <IMAGE_PATH>    [default: images]  ## 解析图片路径，默认为当前images目录
  -r, --rename                                        ## 对解析图片进行重命名，默认为false
  -p, --parse-json                                    ## 开启对推理结果的json进行解析，默认为true
  -h, --help                       Print help
  -V, --version                    Print version

```

- **软件工程目录：** 如下

```

-/
  - config
    - config.json
    - algorithm.json
  - images
    - 算法xxx
    - 算法xxx
    - 算法xxx
  - lvt.exe

```

- **使用示例：** `lvt.exe -c config2 -i images`

  > 命令执行完成后，会在命令窗口所在的路径创建**result**文件夹，将检测为**true**的图片复制到文件夹下面，并生成**result.txt**结果文件


- **本地运行：** `cargo run`

- **配置文件介绍：**

**config.json** ：

```json
{
    "api_key": "sk-xxxxxx",
    "base_url": "http://127.0.0.1:11434/v1",
    "model": "gemma3:4b-it-qat",
    "temperature": 0.5,
    "system_prompt": "你是一个智能安防助手，负责分析监控抓拍图片中的场景，并判断是否存在特定的行为或者事件。",
    "result_prompt":"返回结果使用json格式，包含两个字段：\"result\"和\"confidence\"。\"result\"的值为布尔值，true表示存在摆摊经营，false表示不存在；\"confidence\"的值为0到1之间的浮点数，表示判断结果的置信度。"
}

```

| 字段名称      | 默认值                    | 作用           | 备注                             |
| ------------- | ------------------------- | -------------- | -------------------------------- |
| api_key       | sk-xxxxxx                 | 模型请求验证   | 模型访问需求                     |
| base_url      | http://127.0.0.1:11434/v1 | 模型服务地址   | 模型访问需求                     |
| model         | gemma3:4b-it-qat          | 使用模型的名称 | 模型访问需求                     |
| temperature   | 0.5                       | 模型推理活跃度 | 0到2之间，值越大结果不确定性越高 |
| system_prompt | 无                        | 系统提示词定义 | 作为全局限定                     |
| result_prompt | 无                        | 返回结果定义   | 作为全局限定                     |


**algorithm.json** ：

```json
[
    {
        "id": "00001",
        "name": "摆摊经营",
        "prompt": "这是一张路口的监控抓帕图片，包含了一个摆摊经营的场景。请根据图片中的内容，判断是否存在摆摊经营的行为。",
        "activate": false
    },
    {
        "id": "00002",
        "name": "车辆违停",
        "prompt": "这是一张街道监控抓拍图片，包含了一个车辆违停的场景。请根据图片中的内容，判断是否存在车辆违停的行为。",
        "activate": false
    },
    {
        "id": "00003",
        "name": "烟火监测",
        "prompt": "这是一张城市监控的抓拍图片，有近景和远景，有些是红外光抓拍有些是彩光抓拍。根据图片里面的亮光判断是否有烟火，需要注意晚上路灯的干扰。",
        "activate": true
    }
]

```

| 字段名称 | 默认值 | 作用                             | 备注                   |
| -------- | ------ | -------------------------------- | ---------------------- |
| id       | 无     | 唯一标识                         | 自定义模型编号         |
| name     | 无     | 与images目录下面的检测文件夹对应 | 自定义模型名称         |
| prompt   | 无     | 算法目标定义                     | 算法功能提示词         |
| activate | 无     | 是否开启                         | 灵活配置需要检测的算法 |




## 检测提示词编写技巧

> 使用大模型进行安防检测时，提示词非常的重要，往往一张图片里面包含的信息非常的多。大模型在做检测识别的时候其实是没有什么方向的。我们为其写提示词就是让大模型的检测围绕我们的目标进行。
> 多数情况下，我们能够清楚的描述我们的目标，但是缺乏对目标关联因素的描述，所有往往都不能取得较好的效果。下面是一些技巧，可以参考一下。
> 1. 提示词要尽量简洁，不要包含无关信息。
> 2. 提示词要尽量具体，不要使用模糊的词汇。
> 3. 目标要明确不要让大模型去猜测。
> 4. 影响目标识别的关联因素要尽量描述清楚。
